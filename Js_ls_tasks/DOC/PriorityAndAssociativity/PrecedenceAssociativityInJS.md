#### Еще раз о приоритетах и ассоциативности в JavaScript.

В JavaScript **приоритет** (precedence) и **ассоциативность** (associativity) определяют порядок выполнения операций в 
выражениях, когда используются несколько операторов. Эти концепции важны для понимания, как интерпретатор JavaScript 
обрабатывает выражения, чтобы избежать ошибок и писать предсказуемый код.

---

### 1. **Приоритет операторов**
**Приоритет** определяет, какой оператор выполняется первым в выражении, если их несколько. Операторы с более высоким 
приоритетом выполняются раньше, чем операторы с более низким приоритетом.

#### Примеры приоритета
- Операторы с высоким приоритетом: унарные операторы (`!`, `++`, `--`), умножение (`*`), деление (`/`).
- Операторы с низким приоритетом: присваивание (`=`), логические операторы (`&&`, `||`).

```javascript
const result = 2 + 3 * 4; // Умножение (*) имеет приоритет выше, чем сложение (+)
console.log(result); // 14 (3 * 4 = 12, затем 2 + 12 = 14)
```

Чтобы изменить порядок выполнения, используйте **скобки** — они имеют наивысший приоритет:

```javascript
const result = (2 + 3) * 4; // Скобки принудительно выполняются первыми
console.log(result); // 20 (2 + 3 = 5, затем 5 * 4 = 20)
```

#### Таблица приоритетов (выборка)
Вот некоторые операторы в порядке убывания приоритета (полный список доступен в [MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Operator_Precedence)):

| Приоритет | Оператор | Пример |
|-----------|----------|--------|
| 20        | Скобки | `( )` |
| 17        | Унарные операторы | `!x`, `++x`, `--x`, `typeof x` |
| 14        | Умножение, деление, остаток | `*`, `/`, `%` |
| 13        | Сложение, вычитание | `+`, `-` |
| 12        | Сравнение | `<`, `>`, `<=`, `>=` |
| 11        | Равенство | `==`, `===`, `!=`, `!==` |
| 9         | Логическое И | `&&` |
| 8         | Логическое ИЛИ | `||` |
| 3         | Присваивание | `=`, `+=`, `-=` |

**Особенности:**
- Операторы с одинаковым приоритетом обрабатываются в зависимости от их **ассоциативности** (см. ниже).
- Скобки всегда имеют наивысший приоритет и позволяют явно задавать порядок выполнения.

---

### 2. **Ассоциативность операторов**
**Ассоциативность** определяет порядок выполнения операций, если у операторов **одинаковый приоритет**. Она может быть:
- **Левоассоциативной** (left-to-right): операции выполняются слева направо.
- **Правоассоциативной** (right-to-left): операции выполняются справа налево.

#### Примеры ассоциативности
1. **Левоассоциативные операторы** (большинство арифметических и логических):
   ```javascript
   const result = 10 - 4 - 2; // Выполняется слева направо: (10 - 4) - 2
   console.log(result); // 4
   ```

2. **Правоассоциативные операторы** (например, присваивание, возведение в степень):
   ```javascript
   let a, b;
   a = b = 5; // Присваивание правоассоциативно: b = 5, затем a = b
   console.log(a, b); // 5, 5

   const power = 2 ** 3 ** 2; // Возведение в степень (**): 3 ** 2, затем 2 ** 9
   console.log(power); // 512 (2 ** (3 ** 2))
   ```

#### Основные операторы и их ассоциативность
| Оператор | Ассоциативность | Пример |
|----------|-----------------|--------|
| `+`, `-`, `*`, `/`, `%` | Левоассоциативный | `a + b + c` → `(a + b) + c` |
| `**` (возведение в степень) | Правоассоциативный | `a ** b ** c` → `a ** (b ** c)` |
| `=`, `+=`, `-=`, etc. | Правоассоциативный | `a = b = c` → `a = (b = c)` |
| `&&`, `||` | Левоассоциативный | `a && b && c` → `(a && b) && c` |
| `==`, `===`, `<`, `>` | Левоассоциативный | `a == b == c` → `(a == b) == c` |

**Особенности:**
- Правоассоциативность важна для присваивания и операций вроде `**`, чтобы избежать неожиданного поведения.
- Логические операторы (`&&`, `||`) вычисляются лениво (short-circuit evaluation), что может влиять на порядок выполнения.

---

### Примеры комбинации приоритета и ассоциативности
1. **Смешивание операторов с разным приоритетом**:
   ```javascript
   const result = 2 + 3 * 4 && 5; // 1. 3 * 4 = 12, 2. 2 + 12 = 14, 3. 14 && 5 = 5
   console.log(result); // 5
   ```

2. **Одинаковый приоритет, левоассоциативность**:
   ```javascript
   const result = 10 / 2 / 5; // (10 / 2) / 5 = 5 / 5 = 1
   console.log(result); // 1
   ```

3. **Правоассоциативность присваивания**:
   ```javascript
   let a, b, c;
   a = b = c = 10; // c = 10, затем b = c, затем a = b
   console.log(a, b, c); // 10, 10, 10
   ```

---

### Best Practices

1. **Используйте скобки для явного порядка**:
   - Чтобы избежать путаницы с приоритетом и ассоциативностью, добавляйте скобки для ясности:
     ```javascript
     const result = (a + b) * c; // Явно задаём порядок
     ```

2. **Изучите таблицу приоритетов**:
   - Знание приоритетов операторов помогает писать корректный код без лишних скобок. Например, умножение (`*`) всегда выполняется раньше сложения (`+`).

3. **Осторожно с правоассоциативными операторами**:
   - Для операций вроде `**` или `=` учитывайте, что они выполняются справа налево. Это может повлиять на результат:
     ```javascript
     const power = 2 ** 3 ** 2; // 2 ** (3 ** 2) = 512, а не (2 ** 3) ** 2 = 64
     ```

4. **Избегайте сложных выражений**:
   - Сложные выражения с множеством операторов трудно читать и поддерживать. Разбивайте их на части:
     ```javascript
     // Плохо
     const result = a + b * c / d && e || f;

     // Хорошо
     const temp = b * c / d;
     const result = (a + temp) && e || f;
     ```

5. **Учитывайте ленивую оценку**:
   - Логические операторы (`&&`, `||`) вычисляются лениво, что может влиять на порядок выполнения:
     ```javascript
     const result = false && someFunction(); // someFunction не вызовется
     ```

6. **Проверяйте поведение в тестах**:
   - Если не уверены в порядке выполнения, тестируйте выражения с разными входными данными, чтобы избежать ошибок.

7. **Используйте линтеры**:
   - Инструменты вроде ESLint могут подсказать, где выражения могут быть неоднозначными, и предложить добавить скобки.

---

### Резюме
- **Приоритет** определяет, какой оператор выполняется первым (например, `*` раньше `+`).
- **Ассоциативность** решает порядок для операторов с одинаковым приоритетом (лево- или правоассоциативные).
- **Скобки** позволяют явно задавать порядок выполнения.
- **Лучшая практика**: используйте скобки для читаемости, избегайте сложных выражений, учитывайте ленивую оценку и правоассоциативность.

См. офф. док. : [Operator precedence](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Operator_precedence)